
//def buildno = BUILD_NUMBER

pipeline {
    agent any
    tools {
        // Install the Maven version configured as "M3" and add it to the path.
        maven "maven3.6.3"
    }
    
    
    stages {
    
    stage('Building image') {
            steps{
              sh "docker build -t vishwasahukar/mydockerrepo:latest ."
                  }
              }
              stage('Login') {
			     steps {
				   sh 'docker login -u vishwasahukar --password-stdin dckr_pat_dGtXBigb6aKzyr3k9e1AmUI-hyU'
			}
		}
    stage('Push Image') {
            steps{
              sh "docker push vishwasahukar/mydockerrepo:latest"
                  }
              }
    stage('scan'){
             steps{
            sh "grype vishwasahukar/mydockerrepo:latest"
              }
        }
        
     }
}


